 ======================================================================= Legend  
                                                                         Legend  
      PROGRAM LEGEND                                                     Legend  
      ==============                                                     Legend  
      VERSION 80-1 (SEPTEMBER 1980)                                      Legend  
      VERSION 84-1 (NOVEMBER 1984)                                       Legend  
      VERSION 86-1 (JANUARY 1986) *CORRECTED BASED ON USER COMMENTS      Legend  
                                  *FORTRAN-77/H VERSION                  Legend  
      VERSION 87-1 (JANUARY 1987) *CORRECTED BASED ON USER COMMENTS      Legend  
      VERSION 88-1 (JULY 1988)    *OPTION...INTERNALLY DEFINE ALL I/O    Legend  
                                   FILE NAMES (SEE, SUBROUTINE FILEIO    Legend  
                                   FOR DETAILS).                         Legend  
                                  *IMPROVED BASED ON USER COMMENTS.      Legend  
      VERSION 89-1 (JANUARY 1989) *PSYCHOANALYZED BY PROGRAM FREUD TO    Legend  
                                   INSURE PROGRAM WILL NOT DO ANYTHING   Legend  
                                   CRAZY.                                Legend  
                                  *UPDATED TO USE NEW PROGRAM CONVERT    Legend  
                                   KEYWORDS.                             Legend  
                                  *ADDED LIVERMORE CIVIC COMPILER        Legend  
                                   CONVENTIONS.                          Legend  
      VERSION 92-1 (JANUARY 1992) *FOR ANGULAR DISTRIBUTIONS CALCULATED  Legend  
                                   FROM LEGENDRE COEFFICIENTS, INTERVAL  Legend  
                                   HALF TO CONVERGENCE.                  Legend  
                                  *UPDATED BASED ON USER COMMENTS        Legend  
                                  *ADDED FORTRAN SAVE OPTION             Legend  
                                  *ADDED SELECTED OF DATA TO PROCESS     Legend  
                                   BY MAT/MF/MT/ENERGY RANGES.           Legend  
                                  *WARNING...THE INPUT PARAMETER FORMAT  Legend  
                                   HAS BEEN CHANGED - FOR DETAILS SEE    Legend  
                                   BELOW.                                Legend  
      VERSION 92-2 (SEPT. 1992)   *CORRECTED PROCESSING OF ISOTROPIC     Legend  
                                   ANGULAR DISTRIBUTIONS                 Legend  
      VERSION 94-1 (JANUARY 1994) *VARIABLE ENDF/B DATA FILENAMES        Legend  
                                   TO ALLOW ACCESS TO FILE STRUCTURES    Legend  
                                   (WARNING - INPUT PARAMETER FORMAT     Legend  
                                   HAS BEEN CHANGED)                     Legend  
                                  *CLOSE ALL FILES BEFORE TERMINATING    Legend  
                                   (SEE, SUBROUTINE ENDIT)               Legend  
      VERSION 96-1 (JANUARY 1996) *COMPLETE RE-WRITE                     Legend  
                                  *IMPROVED COMPUTER INDEPENDENCE        Legend  
                                  *ALL DOUBLE PRECISION                  Legend  
                                  *ON SCREEN OUTPUT                      Legend  
                                  *UNIFORM TREATMENT OF ENDF/B I/O       Legend  
                                  *IMPROVED OUTPUT PRECISION             Legend  
                                  *INCREASED MAX. POINTS FROM 5,000      Legend  
                                   TO 20,000.                            Legend  
      VERSION 99-1 (MARCH 1999)   *CORRECTED CHARACTER TO FLOATING       Legend  
                                   POINT READ FOR MORE DIGITS            Legend  
                                  *UPDATED TEST FOR ENDF/B FORMAT        Legend  
                                   VERSION BASED ON RECENT FORMAT CHANGE Legend  
                                  *GENERAL IMPROVEMENTS BASED ON         Legend  
                                   USER FEEDBACK                         Legend  
      VERS. 2000-1 (FEBRUARY 2000)*GENERAL IMPROVEMENTS BASED ON         Legend  
                                   USER FEEDBACK                         Legend  
      VERS. 2001-1 (MARCH 2001)   *UPDATED TO HANDLE COMBINATIONS OF     Legend  
                                   LEGENDRE COEFFICIENTS AT LOW ENERGY   Legend  
                                   AND TABULATED DATA AT HIGH ENERGY.    Legend  
      VERS. 2002-1 (MAY 2002)     *OPTIONAL INPUT PARAMETERS             Legend  
      VERS. 2004-1 (MARCH 2004)   *ADDED INCLUDE FOR COMMON              Legend  
                                  *ZERO ANGULAR DISTRIBUTIONS ARE O.K.   Legend  
                                   (PREVIOUSLY ZERO OR NEGATIVE WAS      Legend  
                                    TREATED AS AN ERROR - ZERO IS O.K.   Legend  
                                    FOR SOME REACTIONS OVER SOME COSINE  Legend  
                                    RANGES)                              Legend  
      VERS. 2006-1 (MARCH 2006)   *INCREASED MAXIMUM NUMBER OF LEGENDRE  Legend  
                                   COEFFICIENTS FROM 50 TO 500.          Legend  
                                   WARNING - THE RECURSION RELATIONSHIP  Legend  
                                   FOR LEGENDRE POLYNOMIALS BECOMES      Legend  
                                   UNSTABLE IN HIGHER ORDER POLYTNOMIALS Legend  
                                   EVEN USING DOUBLE PRECISION.          Legend  
      VERS. 2007-1 (JAN.  2007)   *CHECKED AGAINST ALL ENDF/B=VII.       Legend  
                                  *INCREASED MAX. POINTS FROM 60,000     Legend  
                                   TO 240,000.                           Legend  
      VERS. 2007-2 (MAY   2007)   *CORRECTED SIZE OF XMUBASE IN ANGLEN   Legend  
                                   FOR INCREASED NUMBER OF COEFFICIENTS. Legend  
      VERS. 2010-1 (Apr.  2010)   *General update based on user feedback Legend  
      VERS. 2012-1 (Aug.  2012)   *added CODENAME                        Legend  
                                  *32 and 64 bit Compatible              Legend  
                                  *Added ERROR stop                      Legend  
      VERS. 2015-1 (Jan.  2015)   *Extended OUT9                         Legend  
                                  *Replaced ALL 3 way IF Statements.     Legend  
      VERS. 2015-2 (Oct.  2015)   *OPEN optional LEGEND.INP after        Legend  
                                   OPENING LEGEND.LST.                   Legend  
                                  *Coefficient checks are turned OFF     Legend  
                                   if LEGEND.INP is missing = this       Legend  
                                   agrees with BEST INPUT.               Legend  
                                  *Switched from LISTO to LISTO9         Legend  
                                   (no 10 digit output)                  Legend  
      VERS. 2016-1 (May   2016)   *Changed multiple IF statement to      Legend  
                                   accommodate compiler optimizer        Legend  
                                  *Increased Maximum allowed points per  Legend  
                                   angular distribution from 900 to      Legend  
                                   MAXPOINT (currently 240,000)          Legend  
      VERS. 2017-1 (May   2017)   *More tests. Expanded to handle new    Legend  
                                   R-M (LRF=7) detailed angular          Legend  
                                   distributions.                        Legend  
                                  *Max. points increased to 3,000,000.   Legend  
                                  *All floating input parameters changed Legend  
                                   to characte input + IN9 conversion.   Legend  
                                  *If near COS=0 - set = 0               Legend  
                                  *Default changed to negative fixes.    Legend  
                                  *At end print tallies for,             Legend  
                                   1-Number of negative distributions.   Legend  
                                   2-Number of duplicate or out-of-order Legend  
                                     Ehnergies                           Legend  
                                                                         Legend  
      OWNED, MAINTAINED AND DISTRIBUTED BY                               Legend  
      ------------------------------------                               Legend  
      THE NUCLEAR DATA SECTION                                           Legend  
      INTERNATIONAL ATOMIC ENERGY AGENCY                                 Legend  
      P.O. BOX 100                                                       Legend  
      A-1400, VIENNA, AUSTRIA                                            Legend  
      EUROPE                                                             Legend  
                                                                         Legend  
      ORIGINALLY WRITTEN BY                                              Legend  
      ------------------------------------                               Legend  
      Dermott E. Cullen                                                  Legend  
                                                                         Legend  
      PRESENT CONTACT INFORMATION                                        Legend  
      ---------------------------                                        Legend  
      Dermott E. Cullen                                                  Legend  
      1466 Hudson Way                                                    Legend  
      Livermore, CA 94550                                                Legend  
      U.S.A.                                                             Legend  
      Telephone  925-443-1911                                            Legend  
      E. Mail    RedCullen1@Comcast.net                                  Legend  
      Website    RedCullen1.net/HOMEPAGE.NEW                             Legend  
                                                                         Legend  
      PURPOSE                                                            Legend  
      -------                                                            Legend  
      CALCULATE LINEARLY INTERPOLABLE TABULATED ANGULAR DISTRIBUTIONS    Legend  
      STARTING FROM DATA IN THE ENDF/B FORMAT. ANGULAR DISTRIBUTIONS     Legend  
      MAY BE DESCRIBED IN THE ENDF/B FORMAT IN ONE OF THREE WAYS.        Legend  
      FOR EACH OF THESE THREE FORMS THE USER MAY CHOOSE (SEE, INPUT      Legend  
      OPTIONS) TO EITHER COPY EACH TYPE OF DATA OR TO PROCESS IT AT      Legend  
      AS FOLLOWS,                                                        Legend  
                                                                         Legend  
      (1) ANGULAR DISTRIBUTION IS ISOTROPIC AT ALL ENERGIES (LTT=0)      Legend  
      -------------------------------------------------------------      Legend  
      IN THIS CASE THE INPUT DATA DOES NOT INCLUDE ANY ANGULAR           Legend  
      DISTRIBUTIONS. A SECTION MERELY CONTAINS A FLAG TO INDICATE        Legend  
      THE ANGULAR DISTRIBUTION IS ISOTROPIC AT ALL ENERGIES. IN THIS     Legend  
      CASE THE SECTION IS OUTPUT IN EXACTLY THE SAME FORM IN WHICH IT    Legend  
      WAS READ FROM THE INPUT.                                           Legend  
                                                                         Legend  
      (2) ANGULAR DISTRIBUTIONS GIVEN BY LEGENDRE COEFFICIENTS (LTT=1)   Legend  
      ----------------------------------------------------------------   Legend  
      LEGENDRE COEFFICIENTS ARE GIVEN AT A SERIES OF ENERGIES. AN        Legend  
      INTERPOLATION LAW IS GIVEN BETWEEN ENERGIES. THE INTERPOLATION     Legend  
      LAW BETWEEN ENERGIES IS COPIED AS INPUT (I.E., NO ATTEMPT IS       Legend  
      MADE TO LINEARIZE THE VARIATION WITH ENERGY). FOR EACH ENERGY AT   Legend  
      WHICH LEGENDRE COEFFICIENTS ARE GIVEN A LINEARLY INTERPOLABLE      Legend  
      ANGULAR DISITRIBUTION IS RECONSTRUCTED IN THE SYSTEM IN WHICH THE  Legend  
      THE COEFFICIENTS ARE GIVEN (I.E., CM OR LAB - NO ATTEMPT IS MADE   Legend  
      TO CONVERT FROM ONE SYSTEM TO THE OTHER). A MAXIMUM OF 50 LEGENDRE Legend  
      COEFFICIENTS IS ALLOWED. REGARDLESS OF THE NUMBER OF COEFFICIENTS  Legend  
      INPUT THE PROGRAM WILL ONLY USE COEFFICIENTS UP TO THE LAST ORDER  Legend  
      AT WHICH THE COEFFICIENTS ARE NON-ZERO (E.G. IF COEFFICIENTS P1    Legend  
      THROUGH P12 ARE READ, BUT P9=P10=P11=P12=0.0, THE PROGRAM WILL     Legend  
      ONLY USE COEFFICIENTS UP TO P8). IF OVER 50 NON-ZERO COEFFICIENTS  Legend  
      ARE READ ONLY THE FIRST 50 WILL BE USED.                           Legend  
                                                                         Legend  
      (2) ANGULAR DISTRIBUTIONS IS TABULATED (LTT=2)                     Legend  
      ----------------------------------------------------------------   Legend  
      ANGULAR DISTRIBUTIONS ARE GIVEN AT A SERIES OF ENERGIES. AN        Legend  
      INTERPOLATION LAW IS GIVEN BETWEEN ENERGIES AND A SECOND           Legend  
      INTERPOLATION LAW IS GIVEN AT EACH ENERGY TO INTERPOLATE BETWEEN   Legend  
      THE POINTS IN EACH TABULATED DISTRIBUTION. AT EACH ENERGY THE      Legend  
      ANGULAR DISTRIBUTION WILL BE CONVERTED TO LINEARLY INTERPOLABLE    Legend  
      FORM. THE INTERPOLATION BETWEEN ENERGIES IS OUTPUT EXACTLY AS      Legend  
      INPUT. THE INTERPOLATION LAW AT EACH ENERGY IS OUTPUT TO INDICATE  Legend  
      THE NOW LINEARLY INTERPOLABLE ANGULAR DISTRIBUTION.                Legend  
                                                                         Legend  
      (3) LEGENDRE COEFFICIENTS AND TABULATED (LTT=3)                    Legend  
      ----------------------------------------------------------------   Legend  
      ENDF-102 SAYS THIS SHOULD BE LTT=4, BUT ALL OF THE EVALUATIONS     Legend  
      IN ENDF/B-VI, RELEASE 7, USE LTT=3? THIS CODE WILL TREAT THESE     Legend  
      AS LTT=4 - SEE BELOW.                                              Legend  
                                                                         Legend  
      (4) LEGENDRE COEFFICIENTS AND TABULATED (LTT=4)                    Legend  
      ----------------------------------------------------------------   Legend  
      THIS IS A COMBINATION OF (1) AND (2) DESCRIBED ABOVE. THE          Legend  
      LEGENDRE DATA IS ALWAYS GIVEN FIRST, FOR LOWER ENERGIES,           Legend  
      FOLLOWED BY TABULATED ANGULAR DISTRIBUTIONS, FOR HIGHER ENERGIES.  Legend  
                                                                         Legend  
      THIS TYPE OF DATA CAN ONLY BE COPIED OR ALL CONVERTED TO           Legend  
      TABULATED (LTT=2).                                                 Legend  
                                                                         Legend  
      POINT VALUES - NORMALIZED VS. UNNORMALIZED                         Legend  
      ------------------------------------------------------------------ Legend  
      THE VALUE OF AN ANGULAR DISTRIBUTION AT ANY COSINE WILL BE         Legend  
      CORRECTLY CALCULATED BY THIS CODE, BASED EITHER DIRECTLY ON THE    Legend  
      ANGULAR DISTRIBUTION, OR ON THE SUM OF THE CONTRIBUTING LEGENDRE   Legend  
      MOMENTS.                                                           Legend  
                                                                         Legend  
      ENDF/B ANGULAR DISTRIBUTIONS ARE BY DEFINITION NORMALIZED WHEN     Legend  
      INTEGRATED OVER COSINE. THEREFORE THIS CODE WILL NORMALIZE EACH    Legend  
      ANGULAR DISTRIBUTION BEFORE IT IS OUTPUT. THE OUTPUT REPORT FROM   Legend  
      THIS CODE WILL INDICATE THE NORMALIZATION FACTOR USED.             Legend  
                                                                         Legend  
      THE REASON THAT AN ANGULAR DISTRIBUTION MAY NOT BE NORMALIZED IS   Legend  
      DUE TO THE APPROXIMATION OF CREATING LINEARLY INTERPOLABLE         Legend  
      TABULATED ANGULAR DISTRIBUTIONS - THE MORE ACCURATELY THIS IS      Legend  
      DONE THE CLOSER THE NORMALIZATION FACTOR WILL BE TO UNITY. AS YOU  Legend  
      DECREASE THE ALLOWABLE ERROR THE NORMALIZED VALUES WILL APPROACH   Legend  
      THE CORRECT POINT VALUES CALCULATED BY THE CODE.                   Legend  
                                                                         Legend  
      SINCE THE DATA IS NORMALIZED PRIOR TO OUTPUT THE RESULTS IN THE    Legend  
      ENDF/B FORMAT MAY DIFFER SLIGHTLY FROM VALUES REFERRED TO BE ERROR Legend  
      MESSAGES, ETC. PRINTED BY THE CODE DURING EXECUTION. IN ALL CASES  Legend  
      THE VALUES PRINTED BY THE CODE IN ERROR MESSAGES, ETC. SHOULD BE   Legend  
      CONSIDERED TO BE THE CORRECT VALUES AND THE OUTPUT TABULATED       Legend  
      ANGULAR DISTRIBUTIONS APPROXIMATE DUE TO THE RE-NORMALIZATION -    Legend  
      TO RE-ITERATE, THE OUTPUT TABULATED VALUES ARE APPROXIMATE DUE     Legend  
      TO THE APPROXIMATIONS USED IN CONSTRUCTING LINEAR INTERPOLABLE     Legend  
      ANGULAR DISTRIBUTIONS TO WITHIN SOME ALLOWABLE TOLERANCE.          Legend  
                                                                         Legend  
      ELIMINATION OF NEGATIVE VALUES                                     Legend  
      ------------------------------                                     Legend  
      THE RECONSTRUCTED ANGULAR DISTRIBUTION WILL BE TESTED AND IF IT    Legend  
      IS NEGATIVE AT ONE OR MORE COSINES AN ERROR MESSAGE WILL BE OUTPUT Legend  
      AND BASED ON THE INPUT OPTION SELECTED ONE OF THE FOLLOWING        Legend  
      CORRECTIVE ACTIONS WILL BE TAKEN (SEE, INPUT OPTIONS),             Legend  
      (1) NO CORRECTION                                                  Legend  
      (2) CHANGE INDIVIDUAL LEGENDRE COEFFICIENTS (EACH BY LESS THAN     Legend  
          1.0 PER-CENT) UNTIL THE RECONSTRUCTED ANGULAR DISTRIBUTION     Legend  
          IS POSITIVE (MINIMUM MORE THAN 1 MILLI-BARN). THE ALLOWABLE    Legend  
          PER-CENT CHANGE IN COEFFICIENTS AND MINIMUM CROSS SECTION CAN  Legend  
          BE CHANGED BY INPUT.                                           Legend  
      (3) CHANGE ALL LEGENDRE COEFFICIENTS TO FORCE DISTRIBUTION TO BE   Legend  
          POSITIVE (MINIMUM MORE THAN 1 MILLI-BARN). WITH THIS OPTION    Legend  
          THERE IS NO RESTRICTION ON THE AMOUNT THAT EACH COEFFICIENT    Legend  
          IS CHANGED AND AS SUCH THIS OPTION SHOULD BE USED WITH         Legend  
          CAUTION AND ONLY AS A LAST RESORT IF NO OTHER APPROACH CAN     Legend  
          BE USED TO MAKE THE DISTRIBUTION POSITIVE.                     Legend  
                                                                         Legend  
      OUTPUT                                                             Legend  
      ------                                                             Legend  
      THE USER MAY REQUEST OUTPUT OF EITHER,                             Legend  
      (1) TABULATED VALUES - POSSIBLY CORRECTED TO ELIMINATE NEGATIVE    Legend  
          VALUES. THE TABULATED DISTRIBUTION WILL BE NORMALIZED BEFORE   Legend  
          OUTPUT.                                                        Legend  
      (2) LEGENDRE COEFFICIENTS - POSSIBLY CORRECTED TO ELIMINATE        Legend  
          NEGATIVE VALUES AND WITHOUT HIGHER ORDER ZERO COEFFICIENTS.    Legend  
          BY DEFINITION DISTRIBUTIONS DEFINED BY LEGENDRE COEFFICIENTS   Legend  
          ARE NORMALIZED TO UNITY.                                       Legend  
                                                                         Legend  
      (3) ANGULAR DISTRIBUTIONS GIVEN BY A TABULATION (LTT=2)            Legend  
      -------------------------------------------------------            Legend  
      TABULATED ANGULAR DISTRIBUTIONS ARE GIVEN AT A SERIES OF ENERGIES. Legend  
      AN INTERPOLATION LAW IS GIVEN BETWEEN ENERGIES. THE INTERPOLATION  Legend  
      LAW BETWEEN ENERGIES IS COPIED AS INPUT (I.E., NO ATTEMPT IS       Legend  
      MADE TO LINEARIZE THE VARIATION WITH ENERGY). FOR EACH ENERGY AT   Legend  
      AT WHICH TABULATED DATA ARE GIVEN A LINEARLY INTERPOLABLE ANGULAR  Legend  
      DISTRIBUTION IS CONSTRUCTED IN THE SYSTEM IN WHICH THE TABULATED   Legend  
      DATA ARE GIVEN (I.E., CM OR LAB - NO ATTEMPT IS MADE TO CONVERT    Legend  
      FROM ONE SYSTEM TO THE OTHER). A MAXIMUM OF 60000 POINTS IS ALLOWE Legend  
      TO REPRESENT THE ANGULAR DISTRIBUTION AT EACH ENERGY.              Legend  
                                                                         Legend  
      ELIMINATION OF NEGATIVE VALUES                                     Legend  
      ------------------------------                                     Legend  
      THE RECONSTRUCTED ANGULAR DISTRIBUTION WILL BE TESTED AND IF IT    Legend  
      IS NEGATIVE AT ONE OR MORE COSINES AN ERROR MESSAGE WILL BE OUTPUT Legend  
      AND BASED ON THE INPUT OPTION SELECTED ONE OF THE FOLLOWING        Legend  
      CORRECTIVE ACTIONS WILL BE TAKEN (SEE, INPUT OPTIONS),             Legend  
      (1) NO CORRECTION                                                  Legend  
      (2) CHANGE ALL TABULATED VALUES TO FORCE DISTRIBUTION TO BE        Legend  
          POSITIVE (MINIMUM MORE THAN 1 MILLI-BARN). THE MINIMUM VALUE   Legend  
          MAY BE CHANGED BY INPUT. WITH THIS OPTION THERE IS NO          Legend  
          RESTRICTION ON THE AMOUNT THAT EACH VALUE IS CHANGED AND AS    Legend  
          SUCH THIS OPTION SHOULD BE USED WITH CAUTION AND ONLY AS A     Legend  
          LAST RESORT IF NO OTHER APPROACH CAN BE USED TO MAKE THE       Legend  
          DISTRIBUTION POSITIVE.                                         Legend  
                                                                         Legend  
      OUTPUT                                                             Legend  
      ------                                                             Legend  
      THE OUTPUT WILL BE THE LINEARIZED ANGULAR DISTRIBUTION. THE        Legend  
      TABULATED DISTRIBUTION WILL BE NORMALIZED TO UNITY BEFORE OUTPUT.  Legend  
                                                                         Legend  
      CORRECTING NEGATIVE ANGULAR DISTRIBUTION                           Legend  
      ----------------------------------------                           Legend  
      IF AN ANGULAR DISTRIBUTION IS NEGATIVE AN ERROR MESSAGE WILL BE    Legend  
      PRINTED AND THE USER MAY DECIDE (BASED ON INPUT OPTION) TO,        Legend  
      (1) NOT PERFORM ANY CORRECTIVE ACTION.                             Legend  
      (2) FOR TABULATED DISTRIBUTIONS - ADD THE SAME VALUE TO EACH POINT Legend  
          VALUE SUCH THAT WHEN THE DISTRIBUTION IS RE-NORMALIZED THE     Legend  
          MINIMUM VALUE IS 0.001 (1 MILLI-BARN). THE MINIMUM VALUE CAN   Legend  
          BE CHANGED BY INPUT. WARNING...EXCEPT FOR SELECTION OF THE     Legend  
          MINIMUM VALUE (BY INPUT) THE USER HAS NO CONTROL OVER HOW      Legend  
          MUCH THE DISTRIBUTION IS CHANGED. THEREFORE THIS OPTION SHOULD Legend  
          BE USED WITH CAUTION.                                          Legend  
      (3) FOR LEGENDRE COEFFICIENTS ONE OF TWO OPTIONS MAY BE SELECTED,  Legend  
      (A) CHANGE INDIVIDUAL COEFFICIENTS (NO ONE COEFFICIENT BY MORE     Legend  
          THAN 1 PER-CENT) TO MAKE THE DISTRIBUTION POSITIVE WITH A      Legend  
          MINIMUM VALUE OF 0.001 (1 MILLI-BARN). THE MAXIMUM PER-CENT    Legend  
          CHANGE IN EACH COEFFICIENT AND MINIMUM VALUE MAY BE CHANGED    Legend  
          BY INPUT. INPUT THE PROGRAM CANNOT MAKE THE DISTRIBUTION       Legend  
          POSITIVE BY CHANGING EACH COEFFICIENT BY UP TO THE MAXIMUM     Legend  
          ALLOWABLE AMOUNT, THE ORIGINAL ANGULAR DISTRIBUTION OR         Legend  
          COEFFICIENTS WILL BE OUTPUT. ONLY IN THE LATTER CASE SHOULD    Legend  
          ONE CONSIDER USING OPTION (B) DESCRIBED BELOW.                 Legend  
      (B) LOGICALLY ADD THE SAME VALUE TO EACH POINT VALUE SUCH THAT     Legend  
          WHEN THE DISTRIBUTION IS RE-NORMALIZED THE MINIMUM VALUE IS    Legend  
          0.001 (1 MILLI-BARN). THIS IS EQUIVALENT AT INCREASING P0      Legend  
          BY A CERTAIN AMOUNT AND RE-NORMALIZATION IS EQUIVALENT TO THEN Legend  
          DIVIDING EACH COEFFICIENT BY A CERTAIN AMOUNT. THEREFORE,      Legend  
          WHAT IS PHYSICALLY DONE BY THE PROGRAM IS TO DIVIDE EACH       Legend  
          COEFFICIENT BY THE SAME AMOUNT. WARNING..EXCEPT FOR SELECTION  Legend  
          OF THE MINIMUM VALUE (BY INPUT) THE USER HAS NO CONTROL OVER   Legend  
          HOW MUCH THE DISTRIBUTION IS CHANGED. THEREFORE THIS OPTION    Legend  
          SHOULD BE USED WITH CAUTION.                                   Legend  
                                                                         Legend  
      WARNING MESSAGES FROM PROGRAM                                      Legend  
      -----------------------------                                      Legend  
      THE WARNING MESSAGES PRINTED BY THIS PROGRAM SHOULD ONLY BE        Legend  
      CONSIDERED TO BE EXACTLY THAT..WARNINGS..NOT AN ABSOLUTE JUDGEMENT Legend  
      BY THIS PROGRAM THAT THERE IS SOMETHING WRONG WITH THE DATA. WHEN  Legend  
      WARNING MESSAGES ARE PRINTED EXAMINE THE DATA AND EITHER TAKE NO   Legend  
      ACTION (IF YOU FEEL THAT THE DATA IS O.K.) OR CORRECT THE DATA     Legend  
      (IF YOU FEEL THAT THE DATA IS INCORRECT AND YOU CAN CORRECT IT).   Legend  
                                                                         Legend  
      VALIDITY OF MODIFIED DATA                                          Legend  
      -------------------------                                          Legend  
      BEFORE BELIEVING AND USING DATA WHICH HAS BEEN MODIFIED (EITHER    Legend  
      TABULATED ANGULAR DISTRIBUTIONS OR LEGENDRE COEFFICIENTS) THE USER Legend  
      SHOULD INSURE THAT THE MODIFIED DATA IS PHYSICALLY MORE ACCEPTABLE Legend  
      THAN THE ORIGINAL DATA. IN ORDER TO DO THIS ONE OR MORE OF THE     Legend  
      FOLLOWING METHODS SHOULD BE USED,                                  Legend  
                                                                         Legend  
      (1) USE THE ENERGY VARIATION TESTS BUILT-IN TO THIS PROGRAM AND    Legend  
          EVALPLOT TO PLOT THE ENERGY DEPENDENCE OF THE LEGENDRE         Legend  
          COEFFICIENTS IN ORDER TO IDENTIFY AND CORRECT (BY HAND...NOT   Legend  
          BY THIS PROGRAM) ANY COEFFICIENTS WHICH HAVE UNREALISTIC       Legend  
          ENERGY AND L ORDER VARIATIONS. THIS SHOULD ALWAYS BE DONE      Legend  
          FIRST TO ELIMINATE MAJOR PROBLEMS BEFORE USING THIS PROGRAM    Legend  
          TO AUTOMATICALLY MAKE MINOR CORRECTIONS.                       Legend  
      (1) OUTPUT AND PLOT THE UNCORRECTED AND CORRECTED ANGULAR          Legend  
          DISTRIBUTIONS. COMPARE THE PLOTS TO INSURE THAT THE CORRECTED  Legend  
          DATA DOES NOT SERIOUSLY CHANGE THE ENERGY DEPENDENCE OF THE    Legend  
          ANGULAR DISTRIBUTION.                                          Legend  
      (2) IF PLOTTING CAPABILITY IS NOT AVAIALABLE, USE THE PRINTED OUT  Legend  
          OF THIS PROGRAM TO DETERMINE HOW MUCH THE TABULATED ANGULAR    Legend  
          DISTRIBUTION OR LEGENDRE COEFFICIENTS HAVE BEEN MODIFIED.      Legend  
          GENERALLY IF ONE COEFFICIENT HAS BEEN ONLY SLIGHTLY MODIFIED   Legend  
          THE DISTRIBUTION WILL BE ACCEPTABLE. HOWEVER IF MANY           Legend  
          COEFFICIENTS HAVE BEEN MODIFIED THE RESULT WILL NOT BE         Legend  
          RELIABLE.                                                      Legend  
                                                                         Legend  
      SEEING ANGULAR DISTRIBUTIONS AND LEGENDRE COEFFICIENTS             Legend  
      ------------------------------------------------------             Legend  
      PROGRAM EVALPLOT CAN BE USED TO PLOT ANGULAR DISTRIBUTION AND      Legend  
      LEGENDRE COEFFICIENTS - WHEN IT COMES TO CHECKING THIS TYPE OF     Legend  
      DATA THERE IS NO SUBSTITUTE FOR PLOTS OF THE DATA TO MAKE THE      Legend  
      JOB EASY AND STRAIGHTFORWARD.                                      Legend  
                                                                         Legend  
      FOR LEGENDRE COEFFICIENTS EVALPLOT CAN BE USED TO SEE THE ENERGY   Legend  
      DEPENDENCE OF EACH COEFFICIENT - THIS IS AN EXTREMELY EASY AND     Legend  
      USEFUL WAY TO CHECK FOR ERRORS IN THE BASIC DATA.                  Legend  
                                                                         Legend  
      FOR ANGULAR DISTRIBUTION EVALPLOT CAN BE USED TO PLOT THEM AT      Legend  
      EACH ENERGY THAT THEY ARE TABULATED - THIS IS ALSO AN EASY AND     Legend  
      USEFUL WAY TO CHECK FOR ERRORS.                                    Legend  
                                                                         Legend  
      I/O UNIT DEFINITIONS                                               Legend  
      --------------------                                               Legend  
      UNIT  DESCRIPTION                                                  Legend  
      ----  -----------                                                  Legend  
        2   INPUT CARDS                                                  Legend  
        3   OUTPUT REPORT                                                Legend  
       10   ORIGINAL DATA IN ENDF/B FORMAT                               Legend  
       11   FINAL DATA IN ENDF/B FORMAT                                  Legend  
                                                                         Legend  
      OPTIONAL STANDARD FILE NAMES (SEE SUBROUTINE FILIO1 AND FILIO2)    Legend  
      ---------------------------------------------------------------    Legend  
      UNIT  FILE NAME                                                    Legend  
      ----  ----------                                                   Legend  
        2   LEGEND.INP                                                   Legend  
        3   LEGEND.LST                                                   Legend  
       10   ENDFB.IN                                                     Legend  
       11   ENDFB.OUT                                                    Legend  
                                                                         Legend  
      INPUT CARD                                                         Legend  
      ----------                                                         Legend  
  CARD COLS.  FORMAT  DESCRIPTION                                        Legend  
  ---- -----  ------ -----------                                         Legend  
   1    1-11   E11.4 FRACTIONAL THINNING CRITERIA                        Legend  
       12-22   I11   MAXIMUM NUMBER OF POINTS IN ANGULAR DISTRIBUTION    Legend  
                     RECONSTRUCTED FROM LEGENDRE COEFFICIENTS (PRESENT   Legend  
                     LIMITS ARE 11 TO 60000 POINTS)                      Legend  
                    *THIS OPTION CAN BE USED TO RUN QUICK, BUT NOT       Legend  
                     NECESSARILY SO ACCURATE CALCULATIONS - TO ROUGHLY   Legend  
                     SEE WHAT THE ANGULAR DISTRIBUTIONS LOOK LIKE.       Legend  
                    *IT IS RECOMMENDED THAT YOU USE 0 AS INPUT - IN      Legend  
                     WHICH CASE THE PROGRAM WILL USE THE MAXIMUM         Legend  
                     ALLOWABLE NUMBER OF POINTS = 60000.                 Legend  
       23-33   I11   TABULATED ANGULAR DISTRIBUTION TREATMENT            Legend  
                     = 0 - COPY TABLES                                   Legend  
                     = 1 - LINEARIZE TABLES (OUTPUT TABLES)              Legend  
                     = 2 - LINEARIZE AND THIN TABLES (OUTPUT TABLES)     Legend  
       34-44   I11   LEGENDRE COEFFICIENT TREATMENT                      Legend  
                     = 0 - COPY LEGENDRE COEFFICIENTS                    Legend  
                     = 1 - RECONSTRUCT TABULATED ANGULAR DISTRIBUTION.   Legend  
                           (OUTPUT TABLES).                              Legend  
                     = 2 - RECONSTRUCT TABULATED ANGULAR DISTRIBUTION.   Legend  
                           (OUTPUT LEGENDRE COEFFICIENTS).               Legend  
       45-55   I11   NEGATIVE ANGULAR DISTRIBUTION TREATMENT.            Legend  
                     = 0 - NO CORRECTION                                 Legend  
                     = 1 - TABULATE DATA - NO CORRECTION.                Legend  
                         - LEGENDRE DATA - CHANGE COEFFICIENTS           Legend  
                           (NONE BY MORE THAN 1.0 PER-CENT - CAN BE      Legend  
                           CHANGED BY INPUT).                            Legend  
                     = 2 - FORCE DISTRIBUTIONS TO BE POSITIVE            Legend  
                           (TABULATED OR LEGENDRE DATA).                 Legend  
       56-66   I11   LEGENDRE COEFFICIENT VARIATION TEST FLAG.           Legend  
                     = 0 - TEST TESTS.                                   Legend  
                     = 1 - PERFORM TESTS,                                Legend  
                           (A) LEGENDRE ORDER INCREASES WITH ENERGY.     Legend  
                           (C) MONOTONIC VARIATION OF COEFFICIENTS       Legend  
                               AS A FUNCTION OF ENERGY.                  Legend  
                           (C) COEFFICIENTS DECREASE AS A FUNCTION OF    Legend  
                               LEGENDRE ORDER.                           Legend  
    2   1-60   60A1  ENDF/B INPUT DATA FILENAME                          Legend  
                     (STANDARD OPTION = ENDFB.IN)                        Legend  
    3   1-60   60A1  ENDF/B OUTPUT DATA FILENAME                         Legend  
                     (STANDARD OPTION = ENDFB.OUT)                       Legend  
  4-N   1- 6    I6   LOWER MAT LIMIT                                     Legend  
        7- 8    I2   LOWER MF LIMIT                                      Legend  
        9-11    I3   LOWER MT LIMIT                                      Legend  
       12-17    I6   UPPER MAT LIMIT                                     Legend  
       18-19    I2   UPPER MF LIMIT                                      Legend  
       20-22    I3   UPPER MT LIMIT                                      Legend  
       23-33  E11.4  LOWER ENERGY LIMIT                                  Legend  
       34-44  E11.4  UPPER ENERGY LIMIT                                  Legend  
       45-55  E11.4  MINIMUM ALLOWABLE VALUE OF ANGULAR DISTRIBUTION     Legend  
       56-66  E11.4  ALLOWABLE FRACTION (NOT PER-CENT) CHANGE IN ANY     Legend  
                     ONE LEGENDRE COEFFICIENT TO MAKE THE ANGULAR        Legend  
                     DISTRIBUTION POSITIVE (AND AT LEAST EQUAL TO THE    Legend  
                     INPUT MINIMUM ALLOWABLE VALUE).                     Legend  
                                                                         Legend  
      *UP TO 100 MAT/MT/E RANGES MAY BE INPUT, EACH SPECIFYING AN        Legend  
       ALLOWABLE MINIMUM SIGMA AND MAXIMUM CHANGE IN COEFFICIENTS.       Legend  
      *INPUT IS TERMINATED BY A BLANK CARD.                              Legend  
      *ALL MAY/MT/E RANGES NOT SPECIFIED BY INPUT WILL BE TREATED BY     Legend  
       ALLOWING A MINIMUM SIGMA OF 0.001 (1 MILLI-BARN) AND A CHANGE     Legend  
       IN EACH COEFFICIENT BY UP TO 0.01 (1 PER-CENT).                   Legend  
      *THESE MAT/MT/E RANGES ARE NOT USED TO CORRECT ALL ANGULAR         Legend  
       DISTRIBUTIONS WHERE SIGMA IS LESS THAN THE MINIMUM. THEY ARE      Legend  
       ONLY USED TO CORRECT DISTRIBUTION THAT ARE NEGATIVE AND TO        Legend  
       INSURE THAT THE CROSS SECTION AT THE COSINES WHERE THE ANGULAR    Legend  
       DISTRIBUTION ARE INITIALLY NEGATIVE ARE CORRECTED TO BE POSITIVE  Legend  
       AND AT LEAST AS LARGE AS THE MINIMUM ALLOWABLE SIGMA (SPECIFIED   Legend  
       BY INPUT).                                                        Legend  
                                                                         Legend  
      EXAMPLE INPUT NO. 1                                                Legend  
      -------------------                                                Legend  
      PROCESS BOTH LEGENDRE COEFFICIENTS AND TABULATED DATA TO OBTAIN    Legend  
      ANGULAR DISTRIBUTION WHICH ARE ACCURATE TO WITHIN 0.1 PER-CENT     Legend  
      AND OUTPUT UNCORRECTED TABULATED ANGULAR DISTRIBUTION USING        Legend  
      A MAXIMUM OF 501 POINTS IN EACH TABULATED ANGULAR DISTRIBUTION.    Legend  
      SINCE LEGENDRE COEFFICIENTS WILL NOT BE CORRECTED THE INPUT NEED   Legend  
      NOT SPECIFY MAT/MT/E RANGES.                                       Legend  
                                                                         Legend  
      READ /ENDFB6/K300/LEAD.IN AND WRITE /ENDFB6/K300/LEAD.OUT          Legend  
                                                                         Legend  
      THE FOLLOWING 4 INPUT LINES ARE REQUIRED,                          Legend  
                                                                         Legend  
  1.00000- 3        501          2          1          0                 Legend  
  /ENDFB6/K300/LEAD.IN                                                   Legend  
  /ENDFB6/K300/LEAD.OUT                                                  Legend  
      (BLANK CARD TERMINATED INPUT)                                      Legend  
                                                                         Legend  
      EXAMPLE INPUT NO. 2                                                Legend  
      -------------------                                                Legend  
      PROCESS BOTH LEGENDRE COEFFICIENTS AND TABULATED DATA TO OBTAIN    Legend  
      ANGULAR DISTRIBUTION WHICH ARE ACCURATE TO WITHIN 0.1 PER-CENT     Legend  
      AND OUTPUT CORRECTED TABULATED ANGULAR DISTRIBUTION (ONLY THOSE    Legend  
      RE-CONSTRUCTED FROM LEGENDRE COEFFICIENTS WILL BE CORRECTED).      Legend  
      FOR ALL MAT/MT/E CORRECT NEGATIVE ANGULAR DISTRIBUTION TO A VALUE  Legend  
      OF 0.01 (10 MILLI-BARNS) AND ALLOW LEGENDRE COEFFICIENTS TO BE     Legend  
      CHANGED BY UP TO 0.02 (2 PER-CENT).                                Legend  
                                                                         Legend  
      USE THE DEFAULT FILENAMES ENDFB.IN AND ENDFB.OUT (THIS CAN BE      Legend  
      DONE BY LEAVING THE SECOND AND THIRD INPUT LINES BLANK).           Legend  
                                                                         Legend  
      THE FOLLOWING 5 INPUT LINES ARE REQUIRED,                          Legend  
                                                                         Legend  
  1.00000- 3        501          2          1          1                 Legend  
                                                                         Legend  
                                                                         Legend  
      1 1  1  999999999 0.00000+ 0 3.00000+ 7 1.00000- 2 2.00000- 2      Legend  
      (BLANK CARD TERMINATED INPUT)                                      Legend  
                                                                         Legend  
      EXAMPLE INPUT NO. 3                                                Legend  
      -------------------                                                Legend  
      PROCESS BOTH LEGENDRE COEFFICIENTS AND TABULATED DATA TO OBTAIN    Legend  
      ANGULAR DISTRIBUTION WHICH ARE ACCURATE TO WITHIN 0.1 PER-CENT     Legend  
      AND OUTPUT CORRECTED LEGENDRE COEFFICIENTS AND UNCORRECTED         Legend  
      TABULATED ANGULAR DISTRIBUTIONS. FOR MAT=1800, MT=2 CORRECT        Legend  
      NEGATIVE ANGULAR DISTRIBUTIONS TO INSURE THE MINIMUM IS 0.01       Legend  
      (10 MILLI-BARNS) ALLOWING EACH LEGENDRE COEFFICIENT TO CHANGE BY   Legend  
      UP TO 0.02 (2 PER-CENT). ALL OTHER MAT/MT/E WILL BE CORRECTED      Legend  
      TO A MINIMUM OF 0.001 (1 MILLI-BARN) ALLOWING A 0.01 (1 PER-CENT)  Legend  
      CHANGE (BUILT-IN OPTION).                                          Legend  
                                                                         Legend  
      READ /ENDFB6/K300/LEAD.IN AND WRITE /ENDFB6/K300/LEAD.OUT          Legend  
                                                                         Legend  
      THE FOLLOWING 5 INPUT LINES ARE REQUIRED,                          Legend  
                                                                         Legend  
  1.00000- 3        501          2          2          1                 Legend  
  /ENDFB6/K300/LEAD.IN                                                   Legend  
  /ENDFB6/K300/LEAD.OUT                                                  Legend  
   1800 4  2  1800 4  2 0.00000+ 0 3.00000+ 7 1.00000- 2 2.00000- 2      Legend  
      (BLANK CARD TERMINATED INPUT)                                      Legend  
                                                                         Legend  
      EXAMPLE INPUT NO. 4                                                Legend  
      -------------------                                                Legend  
      TO COPY TABULATED ANGULAR DISTRIBUTION AND CONVERT LEGENDRE        Legend  
      COEFFICIENTS TO UNCORRECTED TABULAR DISTRIBUTIONS.                 Legend  
                                                                         Legend  
      USE THE DEFAULT FILENAMES ENDFB.IN AND ENDFB.OUT (THIS CAN BE      Legend  
      DONE BY LEAVING THE SECOND AND THIRD INPUT LINES BLANK).           Legend  
                                                                         Legend  
      THE FOLLOWING 4 INPUT LINES ARE REQUIRED,                          Legend  
                                                                         Legend  
  1.00000- 3        501          0          1          0                 Legend  
                                                                         Legend  
                                                                         Legend  
      (BLANK CARD TERMINATED INPUT)                                      Legend  
                                                                         Legend  
 ======================================================================= Legend  
