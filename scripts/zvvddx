#! /bin/sh -
#SCRIPT TO PLOT ANG. DISTR. AND DOUBLE-DIFFERENTIAL CROSS SECTIONS

XWIN=`uname`
if [ "$XWIN" = "Darwin" ] 
then
export DISPLAY=:0
fi

if [ -z $EMPIREDIR ]; then
    echo "Please set the 'EMPIREDIR' environment variable."
    echo "See Empire v3 documentation for more information."
    exit
fi

file=$1
work=`pwd`
rm C4.DAT ENDF.DAT PLOTC4.LST 2>/dev/null
rm LSTTAB.CUR LSTTAB.PNT HF.DAT 2>/dev/null
ln -sf $work/$file.c4 C4.DAT
ln -sf $work/$file-s.endf ENDF.DAT
ln -sf $work/$file-log.plotc4 PLOTC4.LST

$EMPIREDIR/util/lsttab/lsttab <LSTTAB.INP
rm LSTTAB.INP 2>/dev/null

# stay in local dir, don't cd to util/c4zvd:
if [ ! -f ps01.tit ]; then
   cp $EMPIREDIR/util/c4zvd/ps01.tit ps01.tit
fi
#ln -s $EMPIREDIR/util/c4zvd/ps01.tit ps01.tit        
$EMPIREDIR/util/c4zvd/pntzvdl LSTTAB.PNT LSTTAB.CUR DDXPLOT.zvd \
    || { echo; echo 'zvview closed'; }
if [ "$2" = "" ]
  then
  mv DDXPLOT.zvd $work/$file-last.zvd
else
  mv DDXPLOT.zvd $work/$file-$2.zvd
fi
rm COMPARE.DAT angdis.p92 C4.DAT ENDF.DAT LSTTAB.CUR LSTTAB.PNT PLOTC4.LST LSTTAB.LST LSTTAB.TMP cur.zvd pnt.zvd tmp.dat 2>/dev/null
exit

